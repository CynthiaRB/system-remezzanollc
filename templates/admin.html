<!DOCTYPE html>
<html>
<head>
    <title>Panel Admin</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
    body {
        font-family: 'Segoe UI', sans-serif;
        background-color: #f5f5f5;
        margin: 0;
        padding: 0;
    }

    .navbar {
        background-color: #ffffff;
        padding: 20px 40px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 1px solid #ddd;
    }

    .navbar .saludo {
        font-weight: bold;
        font-size: 16px;
    }

    .navbar img {
        height: 60px;
    }

    .salir {
        background-color: black;
        color: white;
        border: none;
        padding: 10px 18px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 15px;
        display: flex;
        align-items: center;
        gap: 8px;
        transition: background 0.3s;
    }

    .salir:hover {
        background-color: #333;
    }

    .tarjeta {
        background-color: white;
        max-width: 1100px;
        margin: 30px auto;
        padding: 30px;
        border-radius: 12px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.05);
    }

    h3 {
        font-size: 22px;
        margin-bottom: 20px;
        color: #222;
    }

    form {
        display: flex;
        flex-direction: column;
        gap: 15px;
    }

    input, select, textarea {
        padding: 12px;
        font-size: 16px;
        border-radius: 8px;
        border: 1px solid #ccc;
        box-sizing: border-box;
    }

    button, input[type="submit"] {
        padding: 12px 20px;
        background-color: black;
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 15px;
        transition: background 0.3s;
    }

    button:hover, input[type="submit"]:hover {
        background-color: #333;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
    }

    th, td {
        border: 1px solid #ccc;
        padding: 10px;
        text-align: left;
    }

    th {
        background-color: #f0f0f0;
    }

    tr:nth-child(even) {
        background-color: #fafafa;
    }

    .botones {
        margin: 30px auto;
        max-width: 1100px;
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 20px;
    }

    @media (max-width: 768px) {
        .navbar {
            flex-direction: column;
            align-items: flex-start;
            gap: 10px;
            text-align: center;
        }

        .salir {
            align-self: flex-end;
        }

        .tarjeta {
            width: 90%;
            padding: 20px;
        }
    }
    body.dark {
    background-color: #121212;
    color: #e0e0e0;
    }
        body.dark strong,
        body.dark h3,
        body.dark label {
            color: #ffffff;
        }

        body.dark table th,
        body.dark table td {
            color: #f0f0f0;
        }

        body.dark .tarjeta input,
        body.dark .tarjeta select {
            background-color: #2b2b2b;
            color: #ffffff;
            border: 1px solid #555;
        }

        body.dark .tarjeta input::placeholder {
            color: #cccccc;
        }

        body.dark .tarjeta label {
            font-weight: bold;
        }

    body.dark .navbar {
        background-color: #1e1e1e;
        border-bottom: 1px solid #333;
    }

    body.dark .tarjeta,
    body.dark .tabla-container {
        background-color: #1e1e1e;
        box-shadow: none;
    }

    body.dark table {
        background-color: #1e1e1e;
        color: #e0e0e0;
    }

    body.dark th {
        background-color: #333;
    }

    body.dark tr:nth-child(even) {
        background-color: #2a2a2a;
    }

    body.dark input,
    body.dark select,
    body.dark textarea {
        background-color: #2b2b2b;
        color: #f5f5f5;
        border: 1px solid #444;
    }

    body.dark .salir {
        background-color: #444;
    }

    body.dark .salir:hover {
        background-color: #666;
    }
    body.dark .resumen-fila {
    background-color: #1e1e1e !important;
}

body.dark .resumen-fila strong {
    color: #ffffff;
}

body.dark .resumen-fila td {
    background-color: #1e1e1e !important;
    color: #f0f0f0;
}
@media (max-width: 1024px) {
    #form-empleados_activos table {
        display: block;
        overflow-x: auto;
        white-space: nowrap;
    }

    #form-empleados_activos table td,
    #form-empleados_activos table th {
        min-width: 150px;
    }

    #form-empleados_activos table input,
    #form-empleados_activos table select {
        width: 100%;
        box-sizing: border-box;
    }
}
.tabla-scroll {
    overflow-x: auto;
    width: 100%;
}
form input[type="submit"] {
    margin-top: 10px;
}
.botones button {
    background-color: black;
    color: white;
    border: none;
    border-radius: 12px;
    padding: 20px;
    font-size: 16px;
    cursor: pointer;
    transition: transform 0.2s ease, background-color 0.3s ease;
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
    height: 100%;
}

.botones button:hover {
    background-color: #333;
    transform: translateY(-3px);
}

.botones form {
    margin: 0;
}
@media (max-width: 600px) {
    .botones {
        grid-template-columns: 1fr !important;
    }
}
.dashboard-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
  gap: 20px;
  padding: 30px;
  max-width: 1000px;
  margin: 0 auto;
}

.dashboard-grid button {
  background-color: #111;
  color: #fff;
  border: none;
  border-radius: 14px;
  padding: 25px 20px;
  font-size: 16px;
  font-weight: bold;
  cursor: pointer;
  text-align: left;
  transition: all 0.25s ease-in-out;
  box-shadow: 0 6px 18px rgba(0,0,0,0.1);
}

.dashboard-grid button:hover {
  background-color: #2c2c2c;
  transform: translateY(-3px);
}

.dashboard-grid form {
  margin: 0;
}
.grid-opciones {
    display: flex;
    flex-wrap: nowrap;
    justify-content: center;
    gap: 24px;
    overflow-x: auto;
    padding: 30px 20px;
}
.card-opcion {
    min-width: 180px;
}


.card-opcion {
    background-color: #111;
    color: white;
    border-radius: 16px;
    padding: 30px 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    cursor: pointer;
    transition: all 0.25s ease;
    box-shadow: 0 8px 24px rgba(0,0,0,0.15);
    text-decoration: none;
}

.card-opcion:hover {
    background-color: #2a2a2a;
    transform: translateY(-4px);
}

.card-opcion .icono {
    font-size: 36px;
    margin-bottom: 12px;
}

.card-opcion .texto {
    font-size: 16px;
    font-weight: 600;
}


</style>

<script>
    window.addEventListener("scroll", () => {
        const btn = document.getElementById("botonSalir");
        if (window.innerWidth <= 600) {
            if (window.scrollY > 100) {
                btn.classList.add("visible");
            } else {
                btn.classList.remove("visible");
            }
        }
    });
</script>

<body>
                 
   <div class="navbar">
    <div style="display: flex; align-items: center; gap: 15px;">
        <button onclick="toggleDarkMode()" class="salir" id="modoBoton">‚òÄÔ∏è</button>
        <div class="saludo">Hola, Administrador!</div>
    </div>
    <form method="POST" action="/logout">
        <button type="submit" class="salir">üö™ Salir</button>
    </form>
</div>
<div style="text-align: center; margin-top: 20px;">
    <img src="{{ url_for('static', filename='logo.jpg') }}" alt="Logo" style="height: 70px;">
    <h2 class="titulo" style="margin-top: 10px;">Panel Administrador</h2>
</div>


 <!--<div class="botones" style="display: flex; justify-content: center; gap: 20px; margin: 20px 0;">
   <button onclick="mostrarFormulario('proyectos')">Alta de Proyectos</button>
   <button onclick="mostrarFormulario('empleados')">Alta de Usuarios</button>
    <button onclick="mostrarFormulario('activos')">Proyectos Activos</button>
    <button onclick="mostrarFormulario('empleados_activos')">Usuarios Activos</button>
    <form action="/resumen_financiero" method="GET" style="display: inline;">
        <button type="submit">Resumen Financiero</button></form>
        <form action="/resumen_usuarios" method="GET" style="display: inline;">
    <button type="submit">Resumen Usuarios</button></form>
    <form action="/performance" method="GET" style="display: inline;">
    <button type="submit">Performance</button>
    </form>

    </div>-->

<div class="grid-opciones">
  <div class="card-opcion" onclick="mostrarFormulario('proyectos')">
    <div class="icono">üìã</div>
    <div class="texto">Alta de Proyectos</div>
  </div>

  <div class="card-opcion" onclick="mostrarFormulario('empleados')">
    <div class="icono">üë•</div>
    <div class="texto">Alta de Usuarios</div>
  </div>

  <div class="card-opcion" onclick="mostrarFormulario('activos')">
    <div class="icono">üìÅ</div>
    <div class="texto">Proyectos Activos</div>
  </div>

  <div class="card-opcion" onclick="mostrarFormulario('empleados_activos')">
    <div class="icono">üßë‚Äçüíª</div>
    <div class="texto">Usuarios Activos</div>
  </div>

  <a href="/resumen_financiero" class="card-opcion">
    <div class="icono">üí∞</div>
    <div class="texto">Resumen Financiero</div>
  </a>

  <a href="/resumen_usuarios" class="card-opcion">
    <div class="icono">üìä</div>
    <div class="texto">Resumen Usuarios</div>
  </a>

  <a href="/performance" class="card-opcion">
    <div class="icono">üìà</div>
    <div class="texto">Performance</div>
  </a>
</div>

    <!-- FORMULARIO ALTA DE PROYECTOS -->
    <div class="tarjeta" id="form-proyectos" style="display: none;">
        <h3>Registro de Proyecto</h3>
        <form method="POST" action="/admin">
             <label for="fecha_entrega">Fecha de Registro:</label>
            <input type="date" name="fecha" required>
            <label for="fecha_entrega">Fecha de Entrega:</label>
            <input type="date" name="fecha_entrega" required>
             <label for="Cliente">Nombre del Cliente:</label>
            <input type="text" name="cliente" placeholder="Cliente" required>
             <label for="Proyecto">Nombre del Proyecto:</label>
            <input type="text" name="proyecto" placeholder="Nombre del Proyecto" required>
            <label for="Precio">Precio:</label>
            <input type="number" name="precio" placeholder="Precio en USD" required>
            <label for="quien_trajo">¬øQui√©n trajo el proyecto?</label>
            <select name="quien_trajo" required>
                <option value="">Selecciona un usuario</option>
                {% for emp in empleados %}
                <option value="{{ emp[0] }}">{{ emp[0] }} - {{ emp[2]|capitalize }}</option>
                {% endfor %}
            </select>

            <label for="pais">Pa√≠s:</label>
            <select name="pais" required>
                <option value="">Selecciona un pa√≠s</option>
                <option value="M√©xico">M√©xico</option>
                <option value="Per√∫">Per√∫</option>
                <option value="Argentina">Argentina</option>
                <option value="USA">USA</option>
            </select><br>

     <!-- SOCIOS Y EMPLEADOS CENTRADOS -->
                <div style="display: flex; flex-direction: column; align-items: flex-start;">
                    <!-- SOCIOS -->
                    <label for="socios">Socios que participan:</label><br>
                    <div style="display: flex; flex-direction: column; align-items: flex-start;">
                        {% for socio in socios %}
                        <label style="display: flex; align-items: center; gap: 8px; white-space: nowrap;">
                            <input type="checkbox" name="socios" value="{{ socio }}"> {{ socio }}
                        </label>
                        {% endfor %}
                    </div>

                    <!-- EMPLEADOS -->
                    <div style="margin-top: 15px;">
                        <label for="empleados">Usuarios que participan:</label><br><br>
                        <div style="display: flex; flex-direction: column; align-items: flex-start;">
                           {% for empleado in empleados %}
                            {% if empleado[2] == 'empleado' or empleado[2] == 'socio' %}
                            <label style="display: flex; align-items: center; gap: 8px; white-space: nowrap;">
                                <input type="checkbox" name="empleados" value="{{ empleado[0] }}"> {{ empleado[0] }}
                            </label>
                            {% endif %}
                            {% endfor %}

                        </div>
                    </div>
                </div>
     <!-- CAMPO GASTOS Y BOT√ìN -->
                         <input type="submit" value="Registrar Proyecto">
                        </form>
                        </div>

    <!-- FORMULARIO ALTA DE EMPLEADOS -->
    <div class="tarjeta" id="form-empleados" style="display: none;">
        <h3>Registro de Usuarios</h3>
        <form method="POST" action="/alta_empleado">
            <label for="Nombre">Nombre del Usuario:</label>
            <input type="text" name="nombre" placeholder="Ingresa nombre completo" required>

            <label for="pais">Pa√≠s:</label>
            <select name="pais" required>
                <option value="">Selecciona un pa√≠s:</option>
                <option value="M√©xico">M√©xico</option>
                <option value="Per√∫">Per√∫</option>
                <option value="Argentina">Argentina</option>
                <option value="USA">USA</option>
            </select>

            <label for="tipo">Tipo de Usuario:</label>
            <select name="tipo" id="tipo_empleado" onchange="ocultarCamposSiBusiness()" required>
                <option value="empleado">Junior</option>
                <option value="socio">Socio</option>
                <option value="business">Business Developer</option>
            </select>

              <div id="campos_detalle">
                <label for="costo_hora">Costo por hora:</label><br><br>
                <input type="number" name="costo_hora" placeholder="Costo por Hora" required><br><br>
                <label for="costo_hora">Pago Mensual:</label><br><br>
                <input type="number" name="pago_mensual" placeholder="Pago Mensual" required><br><br>
                <label for="costo_hora">Correo:</label><br><br>
                <input type="email" name="correo" placeholder="Correo Asignado" required><br><br>
                <label for="contrasena">Contrase√±a:</label><br><br>
                <input type="text" name="contrasena" placeholder="Contrase√±a" required><br><br>
            </div>

        <input type="submit" value="Registrar Usuario">

        </form>
    </div>

<!-- SECCI√ìN DE EMPLEADOS ACTIVOS -->
<div class="tarjeta" id="form-empleados_activos" style="display: none;">
    <h3>Usuarios </h3>

    <!-- EMPLEADOS -->
    <div class="tabla-scroll">
    <table>
        <tr>
            <th>Nombre</th><th>Pa√≠s</th><th>Tipo</th><th>Costo por hora</th><th>Pago mensual</th><th>Correo</th><th>Contrase√±a</th><th>Acciones</th>
        </tr>
        {% for emp in empleados %}
        {% if emp[2] == 'empleado' %}
        <tr>
            <form method="POST" action="/modificar_empleado">
                <input type="hidden" name="original_correo" value="{{ emp[5] }}">
                <td><input type="text" name="nombre" value="{{ emp[0] }}" required></td>
                <td><input type="text" name="pais" value="{{ emp[1] }}" required></td>
                <td>
                    <select name="tipo" required>
                        <option value="empleado" {% if emp[2] == 'empleado' %}selected{% endif %}>Junior</option>
                        <option value="socio" {% if emp[2] == 'socio' %}selected{% endif %}>Socio</option>
                        <option value="business" {% if emp[2] == 'business' %}selected{% endif %}>Business Developer</option>
                    </select>
                </td>
                <td><input type="number" name="costo_hora" value="{{ emp[3] }}" required></td>
                <td><input type="number" name="pago_mensual" value="{{ emp[4] }}" required></td>
                <td><input type="email" name="correo" value="{{ emp[5] }}" required></td>
                <td><input type="text" name="contrasena" value="{{ emp[6] }}" required></td>
                <td style="display: flex; flex-direction: column; gap: 6px;">
                    <button type="submit" style="width: 100%;">Guardar</button>
            </form>
            <form method="POST" action="/eliminar_empleado">
                <input type="hidden" name="correo" value="{{ emp[5] }}">
                <button type="submit" onclick="return confirm('¬øEliminar este Usuario?')" style="width: 100%;">Eliminar</button>
            </form>
                </td>
        </tr>
        {% endif %}
        {% endfor %}
    </table>
    </div>

    <!-- SOCIOS -->
    <h3>Socios</h3>
    <div class="tabla-scroll">
    <table>
        <tr>
            <th>Nombre</th><th>Pa√≠s</th><th>Tipo</th><th>Costo por hora</th><th>Pago mensual</th><th>Correo</th><th>Contrase√±a</th><th>Acciones</th>
        </tr>
        {% for emp in empleados %}
        {% if emp[2] == 'socio' %}
        <tr>
            <form method="POST" action="/modificar_empleado">
                <input type="hidden" name="original_correo" value="{{ emp[5] }}">
                <td><input type="text" name="nombre" value="{{ emp[0] }}" required></td>
                <td><input type="text" name="pais" value="{{ emp[1] }}" required></td>
                <td>
                    <select name="tipo" required>
                        <option value="empleado" {% if emp[2] == 'empleado' %}selected{% endif %}>Junior</option>
                        <option value="socio" {% if emp[2] == 'socio' %}selected{% endif %}>Socio</option>
                        <option value="business" {% if emp[2] == 'business' %}selected{% endif %}>Business Developer</option>
                    </select>
                </td>
                <td><input type="number" name="costo_hora" value="{{ emp[3] }}" required></td>
                <td><input type="number" name="pago_mensual" value="{{ emp[4] }}" required></td>
                <td><input type="email" name="correo" value="{{ emp[5] }}" required></td>
                <td><input type="text" name="contrasena" value="{{ emp[6] }}" required></td>
                <td style="display: flex; flex-direction: column; gap: 6px;">
                    <button type="submit" style="width: 100%;">Guardar</button>
            </form>
            <form method="POST" action="/eliminar_empleado">
                <input type="hidden" name="correo" value="{{ emp[5] }}">
                <button type="submit" onclick="return confirm('¬øEliminar este socio?')" style="width: 100%;">Eliminar</button>
            </form>
                </td>
        </tr>
        {% endif %}
        {% endfor %}
    </table>
    </div>

    <!-- BUSINESS DEVELOPERS -->
    <h3>Business Developers</h3>
    <div class="tabla-scroll">
    <table>
        <tr>
            <th>Nombre</th><th>Pa√≠s</th>
        </tr>
        {% for emp in empleados %}
        {% if emp[2] == 'business' %}
        <tr>
            <form method="POST" action="/modificar_empleado">
                <td><input type="text" name="nombre" value="{{ emp[0] }}" required></td>
                <td><input type="text" name="pais" value="{{ emp[1] }}" required></td>
                <td style="display: flex; flex-direction: column; gap: 4px;">
                    <button type="submit" style="width: 100%;">Guardar</button>
            </form>
            <form method="POST" action="/eliminar_empleado">
                <input type="hidden" name="correo" value="{{ emp[5] }}">
                <button type="submit" onclick="return confirm('¬øEliminar este BD?')" style="width: 100%;">Eliminar</button>
            </form>
                </td>
        </tr>
        {% endif %}
        {% endfor %}
    </table>
    </div>
</div>


   <div class="tarjeta" id="form-activos" style="display: none;">
    <h3>Proyectos Activos</h3>
    <table>
        <tr><th>Fecha de Registro</th><th>Fecha de Entrega</th><th>Cliente</th><th>Proyecto</th><th>Precio</th><th>Acci√≥n</th></tr>
        {% for p in proyectos %}
        <tr>
            <td>{{ p[0] }}</td>
            <td>
             <form method="POST" action="/actualizar_fecha">
                <input type="hidden" name="proyecto_nombre" value="{{ p[3] }}">
                <input type="date" name="nueva_fecha" value="{{ p[1] }}" onchange="this.form.submit()" style="padding: 5px; border-radius: 6px; border: 1px solid #ccc;">
            </form>
            </td>
            <td>{{ p[2] }}</td>
            <td>{{ p[3] }}</td>
            <td>{{ p[4] }}</td>
            <td>
                <button onclick="toggleResumen('{{ loop.index0 }}', this)">Ver resumen</button>
                <button onclick="mostrarModalGasto('{{ p[3] }}')">Agregar gasto</button>

            </td>
        </tr>
             <tr id="resumen-{{ loop.index0 }}" class="resumen-fila" style="display: none;">

            <td colspan="6">
                <div style="text-align: left; padding: 10px;">
                    <strong>Pa√≠s:</strong> {{ p[5] }}<br>
                    <strong>Quien trajo el proyecto:</strong> {{ p[9] }}<br>
                    <strong>Socios:</strong> {{ p[6] }}<br>
                    <strong>Usuarios:</strong> {{ p[7] }}<br>
                    <strong>Gastos:</strong><br>
                    <table style="width: 100%; border: 1px solid #ccc; margin-top: 5px;">
                    <thead>
                        <tr><th>Concepto</th><th>Monto</th></tr>
                    </thead>
                    <tbody>
                    {% set total = 0.0 %}
                        {% for gasto in p[8].split(';') if gasto %}
                            {% set partes = gasto.strip().rsplit(' ', 1) %}
                            {% if partes|length == 2 %}
                                {% set concepto = partes[0] %}
                                {% set monto_str = partes[1].replace('$', '').replace(',', '').strip() %}
                                {% set monto = monto_str | float(default=0.0) %}
                                {% set total = total + monto %}
                                <tr>
                                    <td>{{ concepto }}</td>
                                    <td>${{ "%.2f"|format(monto) }}</td>
                                </tr>
                            {% endif %}
                        {% endfor %}
                        <tr style="font-weight: bold; background-color: #f0f0f0;">
                            <td style="text-align: right;">Total gastos:</td>
                            <td>${{ "%.2f"|format(totales_gastos.get(p[3], 0.0)) }}</td>

                        </tr>


                    </tbody>
                </table>

             <br><strong>Resumen de horas por usuario:</strong>
            <table style="width: 100%; border: 1px solid #ccc; margin-top: 10px;">
                <thead>
                    <tr><th>Usuario</th><th>Fecha</th><th>Descripci√≥n</th><th>Inicio</th><th>Fin</th><th>Horas</th><th>Costo</th></tr>
                </thead>
                <tbody>
                    {% set resumen = horas_empleado.get(p[3], {}) %}
                    {% for emp in resumen %}
                        {% set datos = resumen[emp] %}
                        {% for tarea in datos.tareas %}
                        <tr>
                            <td>{{ emp }}</td>
                            <td>{{ tarea[0] }}</td>
                            <td>{{ tarea[1] }}</td>
                            <td>{{ tarea[2] }}</td>
                            <td>{{ tarea[3] }}</td>
                            <td>
                                {% set h1 = tarea[2].split(':') %}
                                {% set h2 = tarea[3].split(':') %}
                                {% set horas = (h2[0]|int + h2[1]|int/60) - (h1[0]|int + h1[1]|int/60) %}
                                {% if horas < 0 %}{% set horas = horas + 24 %}{% endif %}
                                {{ "%.2f"|format(horas) }}
                            </td>
                            <td>
                                {% set costo_hora = costos_usuarios.get(emp, 0.0) %}
                                ${{ "%.2f"|format(horas * costo_hora) }}
                            </td>

                        </tr>
                        {% endfor %}
                        <tr style="font-weight: bold; background-color: #f0f0f0;">
                            <td colspan="5" style="text-align: right;">Total {{ emp }}:</td>
                            <td>{{ "%.2f"|format(datos.total) }} hrs</td>
                             <td>
                            {% set costo_hora = costos_usuarios.get(emp, 0.0) %}
                            ${{ "%.2f"|format(datos.total * costo_hora) }}
                        </td>
                        </tr>
                    {% else %}
                        <tr><td colspan="6">Sin horas registradas</td></tr>
                    {% endfor %}
                    <!-- TOTAL HORAS DEL PROYECTO -->
                    <tr style="font-weight: bold; background-color: #e0e0e0;">
                    <td colspan="5" style="text-align: right;">Total horas del proyecto:</td>
                    <td>
                        {{ "%.2f"|format(horas_empleado.get(p[3], {}).values()|map(attribute='total')|sum) }} hrs
                    </td>
                       
                     </tr>

                </tbody>
            </table>

                        <!-- FORMULARIO OCULTO PARA AGREGAR GASTO -->
                 <div id="form-gasto-{{ loop.index0 }}" style="display: none; margin-top: 20px;">
               <form method="POST" action="/agregar_gasto" style="margin-top: 10px;">
                <input type="hidden" name="proyecto_gasto" value="{{ p[3] }}">
                <input type="text" name="concepto_gasto" placeholder="Concepto" required><br>
                <input type="number" name="monto_gasto" placeholder="Monto" required><br>
                <button type="submit" onclick="ocultarFormularioGasto({{ loop.index0 }})">Guardar gasto</button>
            </form>

        </div>
                       </div>
                    </td>
                </tr>
    
        {% endfor %}


<script>
    
function actualizarResumen() {
    const socios = Array.from(document.querySelectorAll('input[name="socios"]:checked')).map(el => el.value);
    const empleados = Array.from(document.querySelectorAll('input[name="empleados"]:checked')).map(el => el.value);

    const resumenDiv = document.getElementById("resumen-proyecto");
    if (resumenDiv) {
        resumenDiv.innerHTML = `
            <strong>Socios seleccionados:</strong> ${socios.join(", ")}<br>
            <strong>Empleados seleccionados:</strong> ${empleados.join(", ")}
        `;
    }
}
</script>
<script>
        function mostrarFormulario(seccion) {
            const todasSecciones = [
                "form-proyectos",
                "form-empleados",
                "form-activos",
                "form-empleados_activos"
            ];

            todasSecciones.forEach(id => {
                const elemento = document.getElementById(id);
                if (elemento) {
                    elemento.style.display = "none";
                }
            });

            const visible = document.getElementById("form-" + seccion);
            if (visible) {
                visible.style.display = "block";
            }

            if (seccion === "proyectos") {
                setTimeout(() => {
                    document.querySelectorAll('input[name="socios"]').forEach(el =>
                        el.addEventListener('change', actualizarResumen)
                    );
                    document.querySelectorAll('input[name="empleados"]').forEach(el =>
                        el.addEventListener('change', actualizarResumen)
                    );
                }, 100);
            }
        }
</script>


        <script>
        function toggleResumen(index, boton) {
            const fila = document.getElementById("resumen-" + index);
            if (fila.style.display === "none") {
                fila.style.display = "table-row";
                boton.innerText = "Ocultar";
            } else {
                fila.style.display = "none";
                boton.innerText = "Ver resumen";
            }
        }
        </script>
        <script>
                  function mostrarFormularioGasto(index) {
                // Oculta cualquier formulario de gasto visible
                document.querySelectorAll('[id^="form-gasto-"]').forEach(el => el.style.display = "none");
                // Muestra solo el formulario correspondiente
                document.getElementById("form-gasto-" + index).style.display = "table-row";
            }
            function ocultarFormularioGasto(index) {
                document.getElementById("form-gasto-" + index).style.display = "none";
            }

        </script>
        <!-- Modal para Agregar Gasto -->
<div id="modalGasto" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background-color: rgba(0,0,0,0.5); z-index:9999; justify-content:center; align-items:center;">
    <div style="background:white; padding:30px; border-radius:12px; width:300px; position:relative;">
        <h3>Agregar Gasto</h3>
        <form method="POST" action="/agregar_gasto">
            <input type="hidden" id="proyectoGasto" name="proyecto_gasto">
            <input type="text" name="concepto_gasto" placeholder="Concepto" required style="width:100%; margin-bottom:10px; padding:10px;">
            <input type="number" name="monto_gasto" placeholder="Monto" required style="width:100%; margin-bottom:10px; padding:10px;">
            <div style="display:flex; justify-content: flex-end; gap: 10px;">
                <button type="button" onclick="cerrarModalGasto()" style="background:gray; color:white; padding:8px 12px; border:none; border-radius:6px;">Cancelar</button>
                <button type="submit" style="background:black; color:white; padding:8px 12px; border:none; border-radius:6px;">Guardar</button>
            </div>
        </form>
    </div>
</div>
<script>
function mostrarModalGasto(nombreProyecto) {
    document.getElementById("modalGasto").style.display = "flex";
    document.getElementById("proyectoGasto").value = nombreProyecto;
}

function cerrarModalGasto() {
    document.getElementById("modalGasto").style.display = "none";
}
</script>
<script>
function toggleDarkMode() {
    const body = document.body;
    const boton = document.getElementById("modoBoton");

    body.classList.toggle('dark');
    const esOscuro = body.classList.contains('dark');
    localStorage.setItem('modoOscuro', esOscuro ? 'true' : 'false');

    // Cambiar √≠cono del bot√≥n
    boton.innerText = esOscuro ? 'üåô' : '‚òÄÔ∏è';
}

// Al cargar la p√°gina
window.onload = function () {
    const esOscuro = localStorage.getItem('modoOscuro') === 'true';
    if (esOscuro) {
        document.body.classList.add('dark');
    }
    const boton = document.getElementById("modoBoton");
    if (boton) {
        boton.innerText = esOscuro ? 'üåô' : '‚òÄÔ∏è';
    }
}
</script>

<script>
function ocultarCamposSiBusiness() {
    const tipo = document.getElementById("tipo_empleado").value;
    const campos = document.getElementById("campos_detalle");

    if (tipo === "business") {
        campos.style.display = "none";
        campos.querySelectorAll("input").forEach(input => {
            input.value = "";
            input.removeAttribute("required");
        });
    } else {
        campos.style.display = "block";
        campos.querySelectorAll("input").forEach(input => {
            input.setAttribute("required", true);
        });
    }
}

</script>


</body>
</html>
